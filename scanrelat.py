from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter


def generate_report(report_data, site_url, signature_image_path):
    pdf_filename = f"relatorio_{site_url.replace('/', '_')}.pdf"
    c = canvas.Canvas(pdf_filename, pagesize=letter)

          #------ASSINATURA--------
    
    c.drawImage(signature_image_path, 100, 100, width=200, height=50)
    c.drawString(100, 750, f"Relatório de Segurança do Site: {site_url}")
    y_position = 700
    for category, issues in report_data.items():
        c.drawString(100, y_position, category)
        y_position -= 20
        for issue in issues:
            c.drawString(120, y_position, f"- {issue}")
            y_position -= 15
        y_position -= 20
    c.save()


def get_user_input():
    site_url = input("Digite o link do site que deseja verificar: ")
    return site_url

          #--NIVEIS--
    
report_data = {
    "Urgente": ["Vulnerabilidade crítica encontrada"],
    "Médio": ["Permissões de arquivo inadequadas"],
    "Leve": ["Aviso: Conteúdo não otimizado"]
}

site_url = get_user_input()

signature_image_path = "caminho da imagem de assinatura.png"

generate_report(report_data, site_url, signature_image_path)